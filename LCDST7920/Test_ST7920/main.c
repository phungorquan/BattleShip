#include "LCDST7920.h" // Get NUC131 and LCD functions
#include "BattleMap.h" // Get ship functions
#include "stdbool.h"


uint8_t BattleMap[]=
{
	
	// 1 Array block = 256 elements - ( 0->255)
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 15
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 31
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 47
0x66,0x66,0x66,0x66,0x66,0x66,0x66,0x6B,0x96,0x66,0x66,0x66,0x66,0x66,0x66,0x66, // 63
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 79
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 95
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 111
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 127
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 143
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 159
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 175
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0A,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 191
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 207
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 223
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 239
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 255
	
	// 256 -> 511
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 271
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 287
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 303
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 319
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 335
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 351
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 367
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 383
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 399
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 415
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 431
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 447
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 463
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 479
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 495
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 511

	// 512 -> 767
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 527
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 543
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 559
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 575
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 591
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 607
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 623
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 639
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 655
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 671
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 687
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 703
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 719
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 735
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0A,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 751
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0A,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 767

	// 768 -> 1023
	// x0 -> 1016(4L) 1017(2HH)
	// y0 -> 1000(4L) 1001(2HH), 984(4L) 985(2HH), 968(4L) 969(2HH), 952(4L) 953(2HH), 936(4L) 937(2HH), //920(4L) 921(2HH)
	// y1 -> 920(4L) 921(2HH), 904(4L) 905(2HH), 888(4L) 889(2HH), 872(4L) 873(2HH), 856(4L) 857(2HH), 830(4L) 831(2HH)
	
	// x1 -> 1017(2HL 4L)
	// y0 -> 1001(2HL 4L), 985(2HL 4L), 969(2HL 4L), 953(2HL 4L), 937(2HL 4L), //921(2HL 4L)
	// y1 -> 921,(2HL 4L), 905(2HL 4L), 889(2HL 4L), 873(2HL 4L), 857(2HL 4L), 841(2HL 4L)
	
	// x2 -> 1018(4H 2LH)
	// y0 -> 1002(4H 2LH), 986(4H 2LH), 970(2HL 4L), 954(2HL 4L), 938(2HL 4L), //922(2HL 4L)
	
	// x3 -> 1018(2LL) 1019(4H)
	// y0 -> 1002(2LL) 1003(4H), 986(2LL) 987(4H), 970(2LL) 971(4H), 954(2LL) 955(4H), 938(2LL) 939(4H), //922(2LL) 923(4H)
	
	// x4 -> 1019(4L) 1020(2HH)
	// y0 -> 1003(4L) 1004(2HH), 987(4L) 988(2HH), 971(4L) 972(2HH), 955(4L) 956(2HH), 939(4L) 940(2HH), //923(4L) 924(2HH)
	
	// x5 -> 1020(2HL 4L)
	// y0 -> 1004(2HL 4L), 988(2HL 4L), 972(2HL 4L), 956(2HL 4L), 940(2HL 4L), //924(2HL 4L)
	
	// x6 -> 1021(4H 2LH)
	// y0 -> 1005(4H 2LH), 989(4H 2LH), 973(4H 2LH), 957(4H 2LH), 941(4H 2LH), //925(4H 2LH)
	
	// x7 -> 1021(2LL) 1022(4H)
	// y0 -> 1005(2LL) 1006(4H), 989(2LL) 990(4H), 973(2LL) 974(4H), 957(2LL) 985(4H), 941(2LL) 942(4H), //925(2LL) 926(4H)
	
	// x8 -> 1022(4L) 1023(2HH)
	// y0 -> 1006(4L) 1007(2HH), 990(4L) 991(2HH), 974(4L) 975(2HH), 958(4L) 959(2HH), 942(4L) 943(2HH), //926(4L) 927(2HH)
	
	// x9 -> 1023(2HL 4L)
	// y0 -> 1007(2HL 4L), 991(2HL 4L), 975(2HL 4L), 959(2HL 4L), 943(2HL 4L), 927(2HL 4L)
	
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 783
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 799
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0A,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 815
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 831
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 847
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 863
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 879
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 895
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 911
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 927
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0xD0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 943
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 959
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xC0,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 975
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 991
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 1007
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00, // 1023

};


void SYS_Init(void)
{
    /* Enable Internal RC 22.1184MHz clock */
    CLK_EnableXtalRC(CLK_PWRCON_OSC22M_EN_Msk);

    /* Waiting for Internal RC clock ready */
    CLK_WaitClockReady(CLK_CLKSTATUS_OSC22M_STB_Msk);

    /* Switch HCLK clock source to Internal RC and HCLK source divide 1 */
    CLK_SetHCLK(CLK_CLKSEL0_HCLK_S_HIRC, CLK_CLKDIV_HCLK(1));

    /* Enable external XTAL 12MHz clock */
    CLK_EnableXtalRC(CLK_PWRCON_XTL12M_EN_Msk);

    /* Waiting for external XTAL clock ready */
    CLK_WaitClockReady(CLK_CLKSTATUS_XTL12M_STB_Msk);

    /* Set core clock as PLL_CLOCK from PLL */
    CLK_SetCoreClock(50000000);
	

		SystemCoreClockUpdate();
}




void GPIO_Init()
{
		
		GPIO_SetMode(PB, BIT13, GPIO_PMD_OUTPUT);	// Led
		
		// ####### If you change LCD pins connection, you have also change define pin in LCDST7920.h ########
		GPIO_SetMode(PA, BIT9, GPIO_PMD_OUTPUT);	// RESET
		GPIO_SetMode(PA, BIT8, GPIO_PMD_OUTPUT);	// EN
		GPIO_SetMode(PA, BIT12, GPIO_PMD_OUTPUT);	// RWE
		GPIO_SetMode(PA, BIT13, GPIO_PMD_OUTPUT);	// RS
		
		GPIO_SetMode(PA, BIT0, GPIO_PMD_OUTPUT);	// D0
		GPIO_SetMode(PA, BIT1, GPIO_PMD_OUTPUT);	// D1
		GPIO_SetMode(PA, BIT2, GPIO_PMD_OUTPUT);	// D2
		GPIO_SetMode(PA, BIT3, GPIO_PMD_OUTPUT);	// D3
		GPIO_SetMode(PA, BIT4, GPIO_PMD_OUTPUT);	// D4
		GPIO_SetMode(PA, BIT5, GPIO_PMD_OUTPUT);	// D5
		
		GPIO_SetMode(PF, BIT4, GPIO_PMD_OUTPUT);	// D6
		GPIO_SetMode(PF, BIT5, GPIO_PMD_OUTPUT);	// D7
}



int main(void)
{	
		unsigned int x = 0;
		unsigned int y = 0;
	
    /* Unlock protected registers */
    SYS_UnlockReg();

    /* Init System, peripheral clock and multi-function I/O */
    SYS_Init();
	
    /* Lock protected registers */
    SYS_LockReg();
		
		GPIO_Init();
		
		PB11 = 1;
    delay(1000);
    PB11 = 0;
    delay(1000);
    PB11 = 1;
    delay(1000);
		
	
//		InitLCD_BasicMode();
//		Display_BasicMode("BATTLE SHIP");
	
		InitLCD_Graphic();	
		Display_Graphic(BattleMap);
		// The following code is Test full-fill and destroy all blocks by 'x' symbols (6x6 * 10 * 10) pixels
//		
//		for(x = 0 ; x < 10 ; x++)
//		{
//				for(y = 0; y < 10; y++)
//			{
//				Set_My_Ship_XY(x,y);
//				Set_Enemy_Ship_XY(x,y);
//			}
//		}
//		
//		for(x = 0 ; x < 10 ; x++)
//		{
//				for(y = 0; y < 10; y++)
//			{
//				Destroy_My_Ship_XY(x,y);
//				Destroy_Enemy_Ship_XY(x,y);
//			}
//		}

		while(1)
		{
		}
}
